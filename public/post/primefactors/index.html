<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  
<title>Haskellの素因数分解 | tudurikata</title>


  <link rel="shortcut icon" type="image/png" href="&#x2F;images&#x2F;logo.svg">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  
  <link id="style1" rel="stylesheet" type="text/css" href=https:&#x2F;&#x2F;tudurikata.com&#x2F;maindark.css>
  

</head>

<div class="header">
  <div class="site_title">
    <p><a href="/"><img src="https:&#x2F;&#x2F;tudurikata.com&#x2F;images&#x2F;logo.svg"
      alt="tudurikata" width="70" height=auto></a></p>
    <p><a href="/">&nbsp;tudurikata</a></p>
  </div>
  <div class="menu">
    <a href="/post">>archives</a>
    &nbsp;<a href="/about">>about</a>
  </div>
</div>

<body>
  <section class="section">
    <div class="container">
      
<h2>
  Haskellの素因数分解
</h2>

<div class="date">
  2020-05-02
</div>

<div class="taxonomies">
  
      
      <a href="https://tudurikata.com/categories/code/">/code</a>
      
  
  
      
      &emsp;<a href="https://tudurikata.com/tags/haskell/">#Haskell</a>
      
  
</div>

<p>
  <pre style="background-color:#2b303b;">
<code class="language-hs" data-lang="hs"><span style="color:#8fa1b3;">headPrimeFactor </span><span style="color:#b48ead;">:: Integer -&gt; Integer
</span><span style="color:#c0c5ce;">headPrimeFactor n = </span><span style="color:#b48ead;">if</span><span style="color:#c0c5ce;"> fstprime == </span><span style="color:#d08770;">[]
                    </span><span style="color:#b48ead;">then</span><span style="color:#c0c5ce;"> n
                    </span><span style="color:#b48ead;">else</span><span style="color:#c0c5ce;"> head fstprime
                        </span><span style="color:#b48ead;">where
</span><span style="color:#c0c5ce;">                            fstprime = filter primes [</span><span style="color:#d08770;">2</span><span style="color:#c0c5ce;">..sqrt&#39;]
                            primes x = n </span><span style="color:#8fa1b3;">`</span><span style="color:#c0c5ce;">mod</span><span style="color:#8fa1b3;">`</span><span style="color:#c0c5ce;"> x == </span><span style="color:#d08770;">0
</span><span style="color:#c0c5ce;">                            sqrt&#39; = floor $ sqrt $ fromIntegral n

</span><span style="color:#8fa1b3;">primeFactorsList </span><span style="color:#b48ead;">:: Integer -&gt;</span><span style="color:#c0c5ce;"> [</span><span style="color:#b48ead;">Integer</span><span style="color:#c0c5ce;">]
primeFactorsList </span><span style="color:#d08770;">1 </span><span style="color:#c0c5ce;">= </span><span style="color:#d08770;">[]
</span><span style="color:#c0c5ce;">primeFactorsList n = (headPrimeFactor n) : primeFactorsList (n </span><span style="color:#8fa1b3;">`</span><span style="color:#c0c5ce;">div</span><span style="color:#8fa1b3;">`</span><span style="color:#c0c5ce;"> (headPrimeFactor n))
</span></code></pre><h2 id="memo">メモ</h2>
<p>たとえば<code>primeFactorsList 24 = [2, 2, 2, 3]</code>となるような関数<code>primeFactorsList</code>を作りたい。<br />
このリストがどう定義できるかを考えると、まず先頭の2というのは、24を[2..]で順番に割っていったときの最初の約数とおくことができる。さらにその次の2は、最初の約数である2で24を割った12について、[2..]で順番に割っていったときの最初の約数である。<br />
つまり、リストの<code>head</code>をとっていき、それを再帰でコンスしていくというのが、Haskellによる素因数分解の素朴な解法となるはずだ。</p>
<p><code>headPrimeFactor</code>は<code>primeFactorsList</code>の補助関数で、nの平方根の整数部分までの整数のうち、nの約数となるものを<code>filter primes</code>で抽出し、その先頭の数字を返すもの。ただし、nが素数の場合はリストが空になるので、よく考えず<code>head</code>を使うとエラーが出てしまう（というか出た）。これを回避するために、リストが空である場合とそうでない場合で分岐を作らないといけない（<code>maybeHead</code>で<code>Nothing | Just Integer</code>を返すバージョンも書いてみたが、<code>head</code>を使う場合と使わない場合で分けたほうが当然ながらシンプル）。空の場合はnを、そうでない場合は最も小さい約数を返す関数となる。<br />
これを再帰的にコンスしていくのが<code>primeFactorsList</code>で、仕組みとしては上に書いた通り。</p>
<p>適当な整数を素因数分解してみると、次のようになる。</p>
<pre style="background-color:#2b303b;">
<code class="language-bash" data-lang="bash"><span style="color:#bf616a;">*Main</span><span style="color:#c0c5ce;">&gt; primeFactorsList 2039801
</span><span style="color:#bf616a;">[23,131,677]
</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">0.01</span><span style="color:#c0c5ce;"> secs, 170,624 bytes)
</span></code></pre><pre style="background-color:#2b303b;">
<code class="language-bash" data-lang="bash"><span style="color:#bf616a;">*Main</span><span style="color:#c0c5ce;">&gt; primeFactorsList 2380479237540923
</span><span style="color:#bf616a;">[29,82085490949687]
</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">3.48</span><span style="color:#c0c5ce;"> secs, 2,754,399,560 bytes)
</span></code></pre>
<p>ひとつの整数の素因数分解として速いか遅いか、まだよくわからないけれど…。 
もう少し工夫したやり方があるような気もするなぁ。</p>

</p>




    </div>
  </section>
</body>

<div class="footer">
  <a href="/">tudurikata</a>&emsp;&copy; Kyohei Uto<br>
  powered by <a href="https://www.getzola.org/">Zola</a>, theme <a href="https://gitlab.com/kyoheiu/emily_zola_theme">emily</a>.
</div>

</html>
