<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>tudurikata</title>
  <link rel="stylesheet" href="https:&#x2F;&#x2F;tudurikata.com&#x2F;main.css">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      }
    };
    </script>
    <script type="text/javascript" id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
    </script>
</head>

<div class="header">
  <p><a href="/"><img src="https:&#x2F;&#x2F;tudurikata.com&#x2F;images&#x2F;penguin.svg" alt="tudurikata" width="50" height="50"></a></p>
  <div class="site_title">
    <a href="/">&thinsp;$&thinsp;tudurikata</a>
  </div>
  <div class="menu">
    <a href="/post">>archives</a>
    &nbsp;<a href="/about">>about</a>
  </div>
</div>

<body>
  <section class="section">
    <div class="container">
      
<h1 class="title">
  Arch Linuxインストールメモ(2020)
</h1>
<p class="subtitle"><strong>2020-09-20</strong></p>
<p><p>Arch Linuxインストールの覚書。将来の自分へのメモとして。</p>
<p>liveインストールの時点でどの程度パッケージを入れておくかは自由だが、インストール自体が初めての場合は<code>pacstrap</code>段階では基本パッケージ、エディタ、ネットワーク関係（これも選択肢は複数ある）くらいにとどめておき、後でX以下を入れていくほうが理解が進むのでいいと思う。</p>
<h2 id="insutoruhou-toraburunowei-ran-fang-zhi-ce">インストール後トラブルの未然防止策</h2>
<ul>
<li>ネットワークに接続できない -&gt; インストール時にネットワーク周りのパッケージを導入しておく。</li>
<li><code>pacman</code>が見つからない -&gt; インストール時に<code>base-devel</code>を入れておく。</li>
</ul>
<h2 id="hazimeni">はじめに</h2>
<p>UEFIモードでliveUSBを起動すること</p>
<h2 id="mazuwifijie-sok">まずwifi接続</h2>
<p>wifi-menu</p>
<h2 id="pateisiyon">パーティション</h2>
<h3 id="risutowoque-ren">リストを確認</h3>
<p><code>fdisk -l</code></p>
<h3 id="pateisiyonbureiku">パーティションブレイク</h3>
<p><code>sgdisk --zap-all /dev/nvme0n1</code></p>
<h3 id="pateisiyonfen-ge-kai-shi">パーティション分割開始</h3>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">gdisk /dev/nvmenvme0n1
Command (? for help): o
This option deletes all partitions and creates a new protective MBR.
Proceed? (Y/N): y

Command (? for help): n
Partition number (1-128, default 1): default
First sector (34-xxxxxxxxx, default = xxxx) or {+-}size{KMGTP}: default
Last sector (xxxx-xxxxxxxxx, default = xxxxxxxxx) or {+-}size{KMGTP}: +500M
Hex code or GUID (L to show codes, Enter = 8300): ef00

Command (? for help): n
Partition number (2-128, default 2): default
First sector (34-xxxxxxxxx, default = xxxxxx) or {+-}size{KMGTP}: default
Last sector (xxxxxx-xxxxxxxxx, default = xxxxxxxxx) or {+-}size{KMGTP}: default
Hex code or GUID (L to show codes, Enter = 8300): default

Command (? for help): w

Do you want to proceed? (Y/N): y
OK: writing new GUID partition table (GPT) to /dev/nvme0n1
</span></code></pre><h2 id="huomatuto">フォーマット</h2>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">mkfs.fat -F32 /dev/nvme0n1p1
mkfs.ext4 /dev/nvme0n1p2
</span></code></pre><h2 id="maunto">マウント</h2>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">mount /dev/nvme0n1p2 /mnt
mkdir /mnt/boot
mount /dev/nvme0n1p1 /mnt/boot
</span></code></pre><h2 id="mirarisutonobian-ji">ミラーリストの編集</h2>
<p><code>vi /etc/pacman.d/mirrorlist</code></p>
<h2 id="shi-ji-he-wase">時計合わせ</h2>
<p><code>timedatectl set-ntp true</code></p>
<h2 id="patukeziinsutorukai-shi">パッケージインストール開始</h2>
<h3 id="ji-ben-patukezi">基本パッケージ</h3>
<p><code>pacstrap /mnt base linux linux-firmware base-devel man-deb man-pages</code></p>
<h3 id="netutowakuguan-xi">ネットワーク関係</h3>
<p><code>pacstrap /mnt networkmanager nm-connection-editor network-manager-applet</code></p>
<h3 id="tekisutoedeita">テキストエディタ</h3>
<p><code>pacstrap /mnt nano vi nvim</code></p>
<h3 id="desukutotupuhuan-jing-x">デスクトップ環境（X）</h3>
<p><code>pacstrap /mnt  xorg-server xorg-apps xorg-xinit</code></p>
<h3 id="desukutotupuhuan-jing-wm">デスクトップ環境（WM）</h3>
<p><code>pacstrap /mnt i3</code></p>
<h3 id="i3guan-lian">i3関連</h3>
<p><code>pacstrap /mnt vifm feh picom rxvt-unicode rofi parcellite</code></p>
<h3 id="ri-ben-yu-zhou-ri">日本語周り</h3>
<p><code>pacstrap /mnt fcitx fcitx-mozc fcitx-im fcitx-configtool</code></p>
<h3 id="sonota">その他</h3>
<p><code>pacstrap /mnt chromium xf86-video-intel lightdm lightdm-gtk-greeter</code></p>
<h2 id="fstabzuo-cheng">Fstab作成</h2>
<p><code>genfstab -U /mnt &gt;&gt; /mnt/etc/fstab</code></p>
<h2 id="chroot">chroot</h2>
<p><code>arch-chroot /mnt</code></p>
<h2 id="taimuzon">タイムゾーン</h2>
<p><code>ln -sf /usr/share/zoneinfo/Asia/Tokyo /etc/localtime</code></p>
<h2 id="adjtimesheng-cheng">adjtime生成</h2>
<p><code>hwclock --systohc</code></p>
<h2 id="lang">LANG</h2>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">vi /etc/locale.gen
	en_US.UTF-8 UTF-8
	ja_JP.UTF-8 UTF-8

locale-gen
echo LANG=en_US.UTF-8 &gt; /etc/locale.conf
export LANG=en_US.UTF-8
</span></code></pre><h2 id="hosutonemu">ホストネーム</h2>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">echo hostname &gt; /etc/hostname
vi /etc/hosts
127.0.0.1	localhost
::1		localhost
127.0.1.1	hostname.localdomain	hostname
</span></code></pre><h2 id="rootpasuwado">rootパスワード</h2>
<p><code>passwd</code></p>
<h2 id="ripozitoriatupudeto">リポジトリアップデート</h2>
<p><code>pacman -Syy</code></p>
<h2 id="maikurokodoatupudeto-insutoru">マイクロコードアップデート　インストール</h2>
<p><code>pacman -S intel-ucode</code></p>
<h2 id="boot-loader">boot-loader</h2>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">pacman -S grub efibootmgr
mkdir /boot/efi
mount /dev/nvme0n1p1 /boot/efi
grub-install --target=x86_64-efi --bootloader-id=GRUB --efi-directory=/boot/efi
grub-mkconfig -o /boot/grub/grub.cfg
</span></code></pre><h2 id="zhong-liao-zai-qi-dong">終了・再起動</h2>
<pre style="background-color:#2b303b;">
<code><span style="color:#c0c5ce;">exit
umount -R /mnt
shutdown now
</span></code></pre></p>

    </div>
  </section>
</body>

<div class="footer">
  <a href="/">tudurikata</a>&emsp;&copy; Kyohei Uto | powered by Zola.
</div>

</html>