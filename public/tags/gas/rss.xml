<?xml version="1.0" encoding="UTF-8"?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
      <title>kyoheiu.gitlab.io - GAS</title>
        <link>https://kyoheiu.gitlab.io</link>
        <description>personal notes</description>
        <generator>Zola</generator>
        <language>ja</language>
        <atom:link href="https://kyoheiu.gitlab.io/tags/gas/rss.xml" rel="self" type="application/rss+xml"/>
        <lastBuildDate>Tue, 06 Oct 2020 00:00:00 +0000</lastBuildDate>
        <item>
            <title>Google Assistantに話しかけた内容をメールで自分に送信する</title>
            <pubDate>Tue, 06 Oct 2020 00:00:00 +0000</pubDate>
            <link>https://kyoheiu.gitlab.io/post/memo-on-googlehome/</link>
            <guid>https://kyoheiu.gitlab.io/post/memo-on-googlehome/</guid>
            <description>&lt;p&gt;Google Assistantに話しかけると、スプレッドシートに入力され、さらに内容がメールで自分に送られてくる、という仕組みを作ったのでメモ。要するに音声メモ。&lt;&#x2F;p&gt;
&lt;p&gt;流れは以下の通り。&lt;br &#x2F;&gt;
Google Assistant -&amp;gt; [IFTTT] -&amp;gt; スプレッドシート -&amp;gt; [GAS] -&amp;gt; Gmail送信&lt;&#x2F;p&gt;
&lt;p&gt;最初はIFTTTでSlackへの直接投稿を狙っていたのだが、自宅のGoogle homeでは機能しなかった。スマートフォンのAssistantでは問題なかったので、homeの仕様かもしれないが、似た症例を見つけられず、結果的に送信部分はGAS、という今の形をとることに。IFTTTとGASに分ければ、Gmailでなく他の手段に切り替えたいときも比較的イージーに変更できそう、という点もメリット。&lt;&#x2F;p&gt;
&lt;p&gt;まず、IFTTT経由でのスプレッドシートへの入力について。&lt;br &#x2F;&gt;
THISは以下の通り。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;a.png&quot; alt=&quot;IFTTT_THIS&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;THATはこちら。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;b.png&quot; alt=&quot;IFTTT_THAT&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;日付の&lt;code&gt;CreatedAt&lt;&#x2F;code&gt;、text ingredientが代入される&lt;code&gt;TextField&lt;&#x2F;code&gt;に加えて、定形であるunsentを入力しておく。&lt;br &#x2F;&gt;
スプレットシートはこのようになる。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;c.png&quot; alt=&quot;IFTTT_THIS&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;このスプレッドシートからスクリプトエディタを起動。&lt;br &#x2F;&gt;
コードはこちら。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;htc&quot; class=&quot;language-htc &quot;&gt;&lt;code class=&quot;language-htc&quot; data-lang=&quot;htc&quot;&gt;var recipient = &amp;#x27;mailaddress&amp;#x27;;
var subject = &amp;#x27;memo from Google Assistant&amp;#x27;;
var sheet = SpreadsheetApp.getActiveSheet();
var last_row = sheet.getLastRow();

function main() {
  for(var i = 2; i &amp;lt;= last_row; i++){
    let isSent = sheet.getRange(i, 3);
    if(isSent.getValue() == &amp;#x27;unsent&amp;#x27;){
      var body = sheet.getRange(i, 2).getValue();
      GmailApp.sendEmail(recipient, subject, body);
      isSent.setValue(&amp;#x27;sent&amp;#x27;);
    }
  }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;GAS、というかJavaScriptを触ったことがほとんどないので変なところがありそうだが、今のところ動いている。&lt;&#x2F;p&gt;
&lt;p&gt;家事をしているときに忘れていた用事や入れておいたほうがいいtodoを思いつきがちなので、すぐにGoogle nest等に話しかけることでメモがとれるのはかなり使い勝手がいい。&lt;&#x2F;p&gt;
</description>
        </item>
    </channel>
</rss>
